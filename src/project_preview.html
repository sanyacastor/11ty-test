---
layout: base.njk
tags: preview
permalink: '/preview/{{ preview.title | slug }}/'
templateEngineOverride: md, njk
eleventyComputed:
  title: {{ preview.title }}
  slug: {{ preview.title | slug }}
pagination:
  data: projectWithImages
  alias: preview
  size: 1
  addAllPagesToCollection: true
---

{# {% set project = {
  data: {
      title: preview.title,
      dates: preview.dates,
      collaborators: preview.collaborators,
      cardDescription: preview.cardDescription
  }
} %} <!--!!!Peligro!!! Deleteme--> #}

{% set card_data = {
  data: {
      title: preview.title,
      dates: preview.dates,
      collaborators: preview.collaborators,
      cardDescription: preview.cardDescription
  }
} %}

<link rel="stylesheet" href="bundle.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />

<article>
  <div class='container'>
    <div class="projectPreview_Grid" id="preview_Grid">
      <card>
        {%- include 'summary-card.njk' -%}
      </card>
      <pictures>
        <div class="swiper mySwiper">
          <div class="swiper-wrapper" id="preview_swiperWrapper">
            {% for image in preview.images %}
              <div class="swiper-slide">
                <img src='{{ image.url }}' alt='{{ image.alt }}' style='width: 100%; display: block; object-fit: cover; margin: auto;'></img> <!--style='object-fit: cover;'-->
              </div>
            {% endfor %}
          </div>
          <div class="swiper-button-next"></div>
          <div class="swiper-button-prev"></div>
          <div class="swiper-pagination"></div>
        </div>
      </pictures>
      <!--imgcaption>asd</imgcaption-->
      <main>
        <div class = "projectPreview_mainTextContainer">
          <div class="projectPreview_textContainer">
            <div id="projectPreview_outer">
              <div class="projectPreview_ScrollArticle" id= "preview_scrollableContent">
                <font>
                  {{preview.previewDescription}}
                </font>
              </div>
              <div class="projectPreview_phantomColumn" id = "phantomColumn">
                <div class="projectPreview_phantomTrigger"  id = "phantomTrigger"></div>
              </div>
            </div>
          </div>
          <div class="navigation_panel">
            <div class="navigation_buttons_group">
              <button class="navigation-button left-button"  id="preview_descriptionNavButton_left" > l </button>
              <button class="navigation-button right-button" id="preview_descriptionNavButton_right"> r </button>
              <button class="navigation-button close-button" id="preview_descriptionNavButton_close" > x </button>
            </div>
          </div>

        {# <div class="related_and_full_buttons_container"> #}
          <div class="projectPreview_buttonFullProject_container" id="preview_buttonFullProject" >
            <a href={{ "/projects/project_" ~ preview.title | slug }}>
              full project
            </a>
            <div class="projectPreview_buttonFullProject_arrowRight" id="preview_buttonFullProject_arrow"></div>
          </div>
        {# </div> #}

        </div>
      </main>  
    </div>
  </div><!--container-->
    {# {% include 'relatedAndMoreCards.njk' %} #}
</article>




<script src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/gsap.min.js"></script>

<script src="/_scripts/previewDescriptionScroll.js"></script>
<script src="/_scripts/previewImageSwiper.js"></script>
<script src="/_scripts/windowController.js"></script>

<script>
  var previewDescriptionScrollInstance;
  var previewImageSwiperInstance;
  var gsapTwiner = gsap;

  var windowControllerInstance;
  
  document.addEventListener("DOMContentLoaded", (event) => { /* gsap code */});

  window.addEventListener('load', function() {
    windowControllerInstance = new windowController();
    let isMobileVersion = windowControllerInstance.itisMobile();
    console.log("isMobile: " + isMobileVersion);


    previewDescriptionScrollInstance
                 = new previewDescriptionScroll('projectPreview_outer',
                                            'preview_scrollableContent',
                                            'phantomColumn',
                                            'preview_buttonFullProject',
                                            'preview_buttonFullProject_arrow',
                                            gsapTwiner);

    previewImageSwiperInstance
                 = new previewImageSwiper('mySwiper',
                                          'preview_swiperWrapper');
    assignButtonsEvents();

    previewDescriptionScrollInstance.onload();
    previewImageSwiperInstance.onLoad(isMobileVersion);
  });

  window.addEventListener('resize', function() {
    let isMobileVersion = windowControllerInstance.itisMobile();

    previewDescriptionScrollInstance.onResize();
    previewImageSwiperInstance.recalc(isMobileVersion);
  });

  document.addEventListener('scroll', function() {
    if(windowControllerInstance.itisMobile()){
      if (window.scrollY === 0) {
        console.log("mobile scrolling top");
      }
      else{
        console.log("mobile scrolling");
      }
    }
    else
      console.log("desktop scrolling");
  });

  document
    .getElementById('projectPreview_outer')
    .addEventListener('wheel', function (e) {
      if(windowControllerInstance.itisMobile())
        return;

      // Cross-browser wheel delta
      var delta = e.wheelDelta
        ? e.wheelDelta
        : -e.deltaY;
      
        if(delta>0)
          previewDescriptionScrollInstance.scrollLeft();
        else
          previewDescriptionScrollInstance.scrollRight();
      //  this.scrollLeft -= (delta);
      e.preventDefault();
    }, false);

  document
    .getElementById('preview_swiperWrapper')
    .addEventListener('wheel', function(e) {
      if(windowControllerInstance.itisMobile())
        return;

      var delta = e.wheelDelta ? e.wheelDelta : -e.deltaY;

      if(delta > 0){
        previewImageSwiperInstance.slidePrev();
      } else {
        previewImageSwiperInstance.slideNext();
      }
    });

  function assignButtonsEvents(){
    document.getElementById('preview_descriptionNavButton_left').addEventListener('click', function() {
      previewDescriptionScrollInstance.scrollLeft();
    });

    document.getElementById('preview_descriptionNavButton_right').addEventListener('click', function() {
      previewDescriptionScrollInstance.scrollRight();
    });

    document.getElementById('preview_descriptionNavButton_close').addEventListener('click', function() {
      window.location.href = '/';
    });
  }
</script>